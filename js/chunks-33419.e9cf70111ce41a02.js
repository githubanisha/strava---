(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33419],{316755:function(e,t,n){"use strict";n.d(t,{E:function(){return Q}});var a=n(785893),r=n(667294),s=n(213980),i=n.n(s),o=n(811607),l=n(693197),u=n(840489),c=n(858335),d=n(942941),p=n(797944),g=n(581932),m=n(579988),v=n(223652),h=n(93587),x=n(300269),y=n(929137),_=n(836405),f=n(165346),j=n(46869),S=n(86472),b=n(553329),R=n(54541),w=n(952),k=n(199833),M=n(304567),I=n(456306),N=n(204943),A=n(698727),T=n(624577),O=n(662641);async function G(e){let t=(0,O.Z)(),n=await t.post("/frontend/routes",e);return null==n?void 0:n.data}var L=n(599243),F=n(545996),P=n(616536),q=n.n(P),B=n(462017);let E=e=>{let t=e.map(e=>({id:(0,B.D1)(),latLng:[e.paths[0].origin.lat,e.paths[0].origin.lng]})),n=e[e.length-1];return t.push({id:(0,B.D1)(),latLng:[n.paths[0].target.lat,n.paths[0].target.lng]}),t},C=e=>{switch(e){case"Run":return 2;case"Walk":return 3;case"Hike":return 4;case"TrailRun":return 5;case"GravelRide":return 6;case"MountainBikeRide":return 7;case"Swim":return 10;default:return 1}},H=e=>{switch(e){case"Paved":return 1;case"Unpaved":return 2;case"Lift":return 4;default:return 3}},D=e=>{switch(e){case"Fixed":return 1;case"Google":return 3;case"Segment":return 4;case"Activity":return 5;default:return 2}},z=e=>"Normal"===e?1:2,U=e=>({...e,encoding:"Google"===e.encoding?1:2}),W=(e,t)=>{let n=E(e.legs),a=C(e.routeType);return{metadata:{athlete_id:t,name:e.title,is_private:e.isPrivate,route_type:a,length:e.length,elevation_gain:e.elevationGain,overview:U(e.overview),elevation_profile:U(e.elevationStream),created_at:new Date().getTime()},route:{preferences:{route_type:a},elements:n.map(e=>({element_type:1,waypoint:{point:{lat:e.latLng[0],lng:e.latLng[1]}}})),legs:e.legs.map((e,t)=>({leg_type:D(e.legType),start_element:t,paths:e.paths.map(e=>({path_type:z(e.pathType),origin:e.origin,target:e.target,length:e.length,polyline:U(e.polyline),elevation:U(e.elevation),elevation_gain:e.elevationGain,surface_type_offsets:e.surfaceTypeOffsets.map(e=>{let{surfaceType:t,distanceOffset:n}=e;return{distance_offset:n,surface_type:H(t)}}),grade_adjusted_length:e.gradeAdjustedLength}))}))},starred:e.isStarred}};var V=n(82729);function $(){let e=(0,V._)(["\n  query RouteSaveModalStreamsAndLegsQuery($routeIds: [String!]!) {\n    suggestedRoutes(routeUrls: $routeIds) {\n      route {\n        overview {\n          data\n          encoding\n        }\n        elevationStream {\n          data\n          encoding\n        }\n        legs {\n          legType\n          paths {\n            pathType\n            origin {\n              lat\n              lng\n            }\n            target {\n              lat\n              lng\n            }\n            length\n            elevationGain\n            gradeAdjustedLength\n            surfaceTypeOffsets {\n              distanceOffset\n              surfaceType\n            }\n            elevation {\n              data\n              encoding\n            }\n            polyline {\n              data\n              encoding\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return $=function(){return e},e}function J(){let e=(0,V._)(["\n  query RouteSaveModalStreamsAndLegsQueryForSavedRoutes(\n    $routeIds: [Identifier!]!\n  ) {\n    routes(routeIds: $routeIds) {\n      overview {\n        data\n        encoding\n      }\n      elevationStream {\n        data\n        encoding\n      }\n      legs {\n        legType\n        paths {\n          pathType\n          origin {\n            lat\n            lng\n          }\n          target {\n            lat\n            lng\n          }\n          length\n          elevationGain\n          gradeAdjustedLength\n          surfaceTypeOffsets {\n            distanceOffset\n            surfaceType\n          }\n          elevation {\n            data\n            encoding\n          }\n          polyline {\n            data\n            encoding\n          }\n        }\n      }\n    }\n  }\n"]);return J=function(){return e},e}let X=(0,F.Ps)($()),Y=(0,F.Ps)(J()),Z=e=>{switch(e){case"Run":return(0,a.jsx)(f.default,{});case"Walk":return(0,a.jsx)(j.default,{});case"Hike":return(0,a.jsx)(S.default,{});case"MountainBikeRide":return(0,a.jsx)(R.default,{});case"GravelRide":return(0,a.jsx)(w.default,{});case"TrailRun":return(0,a.jsx)(b.default,{});case"Swim":return(0,a.jsx)(k.default,{});case"BackcountrySki":case"AlpineSki":return(0,a.jsx)(M.default,{});case"RockClimbing":return(0,a.jsx)(N.default,{});case"NordicSkiing":return(0,a.jsx)(I.default,{});default:return(0,a.jsx)(_.default,{})}},Q=e=>{let{isOpen:t,setShowSaveModal:n,routeIdentifier:s,routeTitle:i,routeType:_,length:f,elevationGain:j,currentAthleteId:S,onSave:b,onDismiss:R,onError:w=()=>{},isSuggestedRoute:k=!0}=e,{t:M}=(0,l.D)(),[I,N]=(0,r.useState)(!1),[O,P]=(0,r.useState)(!1),[B,E]=(0,r.useState)(i),[C,H]=(0,r.useState)(!0),[D,z]=(0,r.useState)(!1),U=()=>{n(!1),P(!1),E(i),H(!0),z(!1),R&&R()},V=async e=>{e.preventDefault(),N(!0);let t=k?X:Y,n=await (0,F.yh)(t,{routeIds:[s]}),a=W({...k?n.suggestedRoutes[0].route:n.routes[0],title:B,length:f,elevationGain:j,routeType:_,isStarred:C,isPrivate:D},S);try{await G(a),N(!1),P(!0),b&&b()}catch(e){N(!1),console.log(e),w(e)}};return(0,a.jsx)(g.u_,{className:q().saveModal,isOpen:t,onDismiss:U,"aria-labelledby":"route-detail-save-modal",hasClose:O,children:(0,a.jsx)("div",{className:q().saveRouteForm,children:I?(0,a.jsx)(h.$,{}):O?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:(0,u.W)(q().header,q().savedHeader),children:M("route_save_modal.success.header")}),(0,a.jsxs)("div",{className:q().savedBody,children:[(0,a.jsx)("p",{children:M("route_save_modal.success.message")}),(0,a.jsx)(o.Lu,{content:M("route_save_modal.success.my_routes_link_html",{url:"/athlete/routes"})})]})]}):(0,a.jsxs)("div",{"data-cy":"route_save_modal",children:[(0,a.jsx)("div",{className:q().header,children:M("route_save_modal.header")}),(0,a.jsxs)("div",{className:q().statsAndStar,children:[(0,a.jsxs)(m.j,{listClassName:q().routeStats,children:[(0,a.jsx)(v.k,{label:M("routes_ui.route_types.".concat((0,L.Z)(_))),value:Z(_)}),(0,a.jsx)("div",{className:q().statSeparator}),(0,a.jsx)(v.k,{label:M("routes_ui.distance"),value:(0,a.jsx)(x.r,{value:f})}),(0,a.jsx)("div",{className:q().statSeparator}),(0,a.jsx)(v.k,{label:M("routes_ui.elevation"),value:(0,a.jsx)(y.u,{value:j})})]}),(0,a.jsx)(c.zx,{variant:"icon",onClick:()=>{H(!C)},tabIndex:"-1",type:"button",children:C?(0,a.jsx)(T.default,{fill:p.uB}):(0,a.jsx)(A.default,{})})]}),(0,a.jsxs)("form",{onSubmit:V,children:[(0,a.jsxs)("div",{className:q().inputRow,children:[(0,a.jsx)("label",{htmlFor:"nameInput",children:M("route_save_modal.input_label.name")}),(0,a.jsx)("input",{id:"nameInput",type:"text",name:"name",value:B,"data-cy":"route_title",onChange:e=>E(e.target.value)})]}),(0,a.jsxs)("div",{className:q().inputRow,children:[(0,a.jsx)("label",{htmlFor:"privacyInput",children:M("route_save_modal.input_label.privacy")}),(0,a.jsxs)("div",{className:q().privacyOptions,children:[(0,a.jsxs)("label",{htmlFor:"routePrivacyPublic",children:[(0,a.jsx)(d.Y,{type:"radio",id:"routePrivacyPublic",name:"privacyInput",value:"public",checked:!D,onChange:()=>{z(!1)}}),M("routebuilder.public")]}),(0,a.jsxs)("label",{htmlFor:"routePrivacyPrivate",children:[(0,a.jsx)(d.Y,{type:"radio",id:"routePrivacyPrivate",name:"privacyInput",value:"private",checked:D,onChange:()=>{z(!0)}}),M("routebuilder.private")]})]})]}),(0,a.jsxs)("div",{className:q().actions,children:[(0,a.jsx)(c.zx,{variant:"primaryOutline",onClick:U,"data-cy":"modal_cancel",children:M("route_save_modal.button.cancel")}),(0,a.jsx)(c.zx,{variant:"primary",disabled:""===B.trim(),"data-cy":"modal_save",children:M("route_save_modal.button.save")})]})]})]})})})};Q.propTypes={isOpen:i().bool.isRequired,setShowSaveModal:i().func.isRequired,currentAthleteId:i().number.isRequired,routeIdentifier:i().string.isRequired,routeTitle:i().string.isRequired,routeType:i().string.isRequired,length:i().number.isRequired,elevationGain:i().number.isRequired,isSuggestedRoute:i().bool,onSave:i().func,onDismiss:i().func,onError:i().func}},808558:function(e,t,n){"use strict";n.d(t,{Z:function(){return l},h:function(){return o}});var a,r,s=n(430810),i=n(771778);let o=e=>{let t=(0,i.N0)(e);return{"@context":"https://schema.org","@type":"Organization",name:"Strava",url:t,logo:"".concat(t,"/frontend/assets/landing-pages/images/strava-orange.svg"),sameAs:["https://facebook.com/Strava","https://twitter.com/strava","https://instagram.com/strava","https://youtube.com/stravainc","https://www.linkedin.com/company/strava-inc./","https://stories.strava.com","https://github.com/strava","https://medium.com/strava-engineering"]}};(a=r||(r={})).Staging="staging",a.Production="production";let l=function(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3?arguments[3]:void 0,r=(0,s.YJ)(t)?"staging":"production",[o="",l]=e.split("?"),u=a&&a[r][o]||o;return"".concat((0,i.N0)(t)).concat(u).concat(n&&l?"?".concat(l):"")}},623113:function(e,t,n){"use strict";var a=n(785893),r=n(667294),s=n(809008),i=n.n(s),o=n(304298),l=n.n(o),u=n(14304),c=n(213980),d=n.n(c),p=n(615750),g=n(693197),m=n(808558);let v=e=>{var t;let{url:n,title:s,description:o,ogImage:c,canonicalUrl:d,showAppleSmartbanner:v=!0,includeOrganizationSchema:h=!1,alIosUrl:x,alIosAppName:y,alIosAppStoreId:_,alAndroidUrl:f,alAndroidAppName:j,alAndroidPackage:S,children:b,noIndex:R=!1}=e,{t:w}=(0,g.D)(),[k,M]=n.split("?"),I="www.strava.com",N="https://".concat(I).concat(k),A=new URLSearchParams(M),T=d||N;if(A.has("hl")){let e=A.get("hl");(p.XG[e]||Object.values(p.MV).includes(e))&&(T+="?hl=".concat(e))}let O=(0,r.useMemo)(()=>({title:w("generic.head.title"),description:w("generic.head.description")}),[w]),G=[(0,a.jsx)("link",{rel:"alternate",href:N,hrefLang:"x-default"},"x-default"),(0,a.jsx)("link",{rel:"alternate",href:N,hrefLang:"en"},"en"),(0,a.jsx)("link",{rel:"alternate",href:"".concat(N,"?hl=").concat(p.MV.enGB),hrefLang:p.MV.enGB},p.MV.enGB)];return Object.keys(p.XG).forEach(e=>{let t=p.XG[e];G.push((0,a.jsx)("link",{rel:"alternate",href:"".concat(N,"?hl=").concat(t[0]),hrefLang:e},e)),t.length>1&&t.forEach(e=>{G.push((0,a.jsx)("link",{rel:"alternate",href:"".concat(N,"?hl=").concat(e),hrefLang:e},e))})}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:s||O.title}),(0,a.jsx)("link",{rel:"canonical",href:T}),G,(0,a.jsx)("meta",{name:"title",content:s||O.title}),(0,a.jsx)("meta",{name:"description",content:o||O.description}),(0,a.jsx)("meta",{name:"application-name",content:"Strava"}),(0,a.jsx)("meta",{property:"og:site_name",content:"Strava"}),(0,a.jsx)("meta",{property:"og:url",content:N}),(0,a.jsx)("meta",{property:"og:title",content:s||O.title}),(0,a.jsx)("meta",{property:"og:description",content:o||O.description}),(0,a.jsx)("meta",{property:"og:type",content:"website"}),c&&(0,a.jsxs)(a.Fragment,{children:[c.url&&(0,a.jsx)("meta",{property:"og:image",content:c.url}),c.width&&(0,a.jsx)("meta",{property:"og:image:width",content:c.width}),c.height&&(0,a.jsx)("meta",{property:"og:image:height",content:c.height}),(0,a.jsx)("meta",{property:"og:image:type",content:null!==(t=c.type)&&void 0!==t?t:"image/png"})]}),(0,a.jsx)("meta",{name:"twitter:title",content:s}),(0,a.jsx)("meta",{name:"twitter:description",content:o}),(0,a.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,a.jsx)("meta",{name:"twitter:site",content:"@Strava"}),(null==c?void 0:c.url)&&(0,a.jsx)("meta",{property:"twitter:image",content:c.url}),(0,a.jsx)("meta",{name:"mobile-web-app-capable",content:"yes"}),v&&(0,a.jsx)("meta",{name:"apple-itunes-app",content:"app-id=426826309"}),x&&(0,a.jsx)("meta",{property:"al:ios:url",content:x}),y&&(0,a.jsx)("meta",{property:"al:ios:app_name",content:y}),_&&(0,a.jsx)("meta",{property:"al:ios:app_store_id",content:_}),f&&(0,a.jsx)("meta",{property:"al:android:url",content:f}),j&&(0,a.jsx)("meta",{property:"al:android:app_name",content:j}),S&&(0,a.jsx)("meta",{property:"al:android:package",content:S}),R&&(0,a.jsx)("meta",{name:"robots",content:"noindex"}),b]}),h&&(0,a.jsx)(l(),{strategy:"beforeInteractive","data-testid":"organization-schema",type:"application/ld+json",children:(0,u.sanitize)(JSON.stringify((0,m.h)(I)))})]})};v.propTypes={url:d().string.isRequired,title:d().string,description:d().string,canonicalUrl:d().string,ogImage:d().shape({url:d().string,height:d().number,width:d().number,type:d().string}),alIosUrl:d().string,alIosAppName:d().string,alIosAppStoreId:d().string,alAndroidUrl:d().string,alAndroidAppName:d().string,alAndroidPackage:d().string,showAppleSmartbanner:d().bool,includeOrganizationSchema:d().bool,children:d().node,noIndex:d().bool},t.Z=v},616536:function(e){e.exports={saveModal:"RouteSaveModal_saveModal__IXWoa",saveRouteForm:"RouteSaveModal_saveRouteForm__YArtx",header:"RouteSaveModal_header__aPRxb",savedHeader:"RouteSaveModal_savedHeader__G6Ob_",savedBody:"RouteSaveModal_savedBody__3JkHs",statsAndStar:"RouteSaveModal_statsAndStar__yosqT",routeStats:"RouteSaveModal_routeStats__gNxWF",statSeparator:"RouteSaveModal_statSeparator__GE1E2",inputRow:"RouteSaveModal_inputRow__Oau18",privacyOptions:"RouteSaveModal_privacyOptions__WJ8hi",actions:"RouteSaveModal_actions__lrKVp"}},300269:function(e,t,n){"use strict";n.d(t,{r:function(){return i}});var a=n(667294),r=n(925703),s=n(425813);let i=e=>{let{value:t,...n}=e,{locale:i,unitSystem:o}=(0,s.Hs)();return a.createElement(a.Fragment,null,(0,r.B)(i,o,t,n))}},929137:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var a=n(667294),r=n(990450),s=n(425813);let i=e=>{let{value:t,...n}=e,{locale:i,unitSystem:o}=(0,s.Hs)();return a.createElement(a.Fragment,null,(0,r.F)(i,o,t,n))}},488186:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var a=n(667294),r=n(178890),s=n(425813);let i=e=>{let{value:t,...n}=e,{locale:i,unitSystem:o}=(0,s.Hs)();return a.createElement(a.Fragment,null,(0,r.i)(i,o,t,n))}}}]);